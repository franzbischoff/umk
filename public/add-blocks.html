<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <title>UYAMAK: Add blocks</title>
  <link rel="manifest" href="manifest.json" />
  <script src="https://www.gstatic.com/firebasejs/5.5/firebase.js"></script>
  <script src="js/config.js"></script>
  <script src="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.js"></script>
  <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="stylesheet" href="/css/notyf.min.css" />

  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css" />
  <link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-w3schools.css" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
    integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous" />

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
</head>

<body>
  <div id="app">
    <div v-if="waitForAProcess.show" class="w3-modal w3-display-container" style="display: block;">
      <div class="w3-display-middle w3-center w3-padding" style="background-color: rgba(255, 255, 255, 0.5);">
        <p v-html="waitForAProcess.title" class="w3-large">
          Connecting to server
        </p>
        <div class="fa-3x">
          <i class="fas fa-spinner fa-pulse"></i>
        </div>
        <p v-html="waitForAProcess.text" class="w3-large">
          Please wait while loading the app. If this process takes longer than
          a minute, check your internet connection and refresh the page.
        </p>
      </div>
    </div>
    <div class="w3-padding" style="max-width: 500px; width:100%; margin: 0 auto; z-index: 2;"
      v-if="(! selectedBlock) && (!! blocksSummary)">
      <div>
        <label>Choose a category</label>
        <select class="w3-select w3-border w3-border-theme" style="cursor: pointer;" v-model.trim="selectedCategory">
          <option value="" disabled selected>Choose a category</option>
          <option v-for="(option, index) in blocksSummaryArray" v-bind:value="option.key">{{ option.name }}
          </option>
        </select>
        <div v-if="!!blocksSummary[selectedCategory]" class="w3-small">
          {{ blocksSummary[selectedCategory].description }}
        </div>
        <div class="w3-btn w3-ripple w3-block" @click="showSummaryItem()">
          Add a new function
        </div>
        <input class="w3-input w3-border w3-border-theme" v-model="filterForFunctions" type="text"
          placeholder="Search ..." />
        <ul class="w3-ul w3-border w3-border-theme">
          <li class="w3-bar w3-border-theme w3-button w3-ripple w3-hover-theme" v-for="(block, index) in filteredBlocks"
            style="cursor: pointer;" v-on:click="showSummaryItem(block.key)">
            <img v-bind:src="prepareSVGURL(block.icon)" class="w3-bar-item tempSVGImg"
              style="height: 42.4px; padding: 0" />
            <div class="w3-bar-item" v-bind:title="block.description">
              <span class="w3-large">{{ block.name }}</span>
            </div>
          </li>
        </ul>
      </div>
    </div>
    <div class="w3-sidebar w3-card w3-padding" style="width:calc(50% - 5px);"
      v-if="(!! selectedBlock) && (!! blocksSummary)">
      <div>
        <h1>
          {{ blocksSummary[selectedCategory].name }} >
          {{ tempSummaryItem.name }}
        </h1>
        <label>Index: {{ selectedBlock }}</label><br />
        <label>Name</label>
        <input class="w3-input w3-border w3-border-theme" type="text" v-model.trim="tempSummaryItem.name" />
        <label>Description</label>
        <input class="w3-input w3-border w3-border-theme" type="text" v-model.trim="tempSummaryItem.description" />
        <label>Icon</label>
        <div class="w3-row">
          <div class="w3-col s6">
            <textarea class="w3-input w3-border w3-border-theme"
              style="resize: none; height: 300px;  font-family: monospace;"
              v-model.trim="tempSummaryItem.icon"></textarea>
            <div class="w3-right w3-btn w3-red" @click="addIconTag(-1)">
              Clear icon
            </div>
          </div>
          <div class="w3-col s6 w3-center">
            <img v-bind:src="prepareSVGURL(tempSummaryItem.icon)" class="w3-bar-item tempSVGImg"
              style="height: 300px; padding: 0" @click="copyIconForBlock" />
          </div>
        </div>
        <!--p>Add the following item to Icon</p-->
        <div class="w3-center" style="margin-top: 16px;">
          <div class="w3-bar-item w3-btn w3-blue" @click="addIconTag(0)">
            Text
          </div>
          <div class="w3-bar-item w3-btn w3-reg" @click="addIconTag(1)">
            Line
          </div>
          <div class="w3-bar-item w3-btn w3-green" @click="addIconTag(2)">
            Polyline
          </div>
          <div class="w3-bar-item w3-btn w3-khaki" @click="addIconTag(3)">
            Path
          </div>
          <div class="w3-bar-item w3-btn w3-teal" @click="addIconTag(4)">
            Polygon
          </div>
          <div class="w3-bar-item w3-btn w3-yellow" @click="addIconTag(5)">
            Rectangle
          </div>
          <div class="w3-bar-item w3-btn w3-indigo" @click="addIconTag(6)">
            Circle
          </div>
          <div class="w3-bar-item w3-btn w3-purple" @click="addIconTag(7)">
            Ellipse
          </div>
        </div>
        <label>Default size</label>
        <div class="w3-row">
          <div class="w3-col s6">
            <label>Width</label>
            <input class="w3-input w3-border w3-border-theme" type="number"
              v-model.number.trim="tempSummaryItem.size.width" />
          </div>
          <div class="w3-col s6">
            <label>Height</label>
            <input class="w3-input w3-border w3-border-theme" type="number"
              v-model.number.trim="tempSummaryItem.size.height" />
          </div>
        </div>

        <label>Order</label>
        <input class="w3-input w3-border w3-border-theme" type="number" v-model.number.trim="tempSummaryItem.order" />
        <div class="w3-center" style="margin-top: 16px;">
          <div class="w3-bar-item w3-btn w3-green" @click="saveDataToServer()">
            Save
          </div>
          <div class="w3-bar-item w3-btn w3-blue" @click="saveDataToServer(true)">
            Save & close
          </div>
          <div class="w3-bar-item w3-btn w3-yellow" @click="selectedBlock=null">
            Cancel
          </div>
          <div class="w3-bar-item w3-btn w3-red" @click="deleteDataOnServer()">
            Delete
          </div>
        </div>
      </div>
    </div>
    <div class="w3-sidebar w3-card w3-padding" style="width:calc(50% - 5px); right:0;" v-if="selectedBlock">
      <h1>Block details</h1>
      <label>Item = {bid: "{{ selectedBlock }}"</label>
      <label>, Colors:
        {{ JSON.stringify(blocksSummary[selectedCategory].colors) }}</label>
      <label>, Name:</label>
      <input class="w3-input w3-border w3-border-theme" v-model.trim="tempSummaryItem.name" />
      <label>, Description:</label>
      <input class="w3-input w3-border w3-border-theme" v-model.trim="tempSummaryItem.description" />
      <label>, Icon: function () {</label>
      <textarea class="w3-input w3-border w3-border-theme"
        style="resize: vertical; height: 75%;  font-family: monospace;" v-model.trim="tempBlock.Icon"></textarea>
      <label>}, Parameters:</label>
      <textarea class="w3-input w3-border w3-border-theme"
        style="resize: vertical; height: 75%;  font-family: monospace;" v-model.trim="tempBlock.Parameters"></textarea>
      <label>,</label><label for="firstInExecOrder"> FirstInExecutionOrder:</label><input
        v-model="FirstInExecutionOrder" type="checkbox" id="firstInExecOrder" />
      <label>, Label: function () {</label>
      <textarea class="w3-input w3-border w3-border-theme"
        style="resize: vertical; height: 75%;  font-family: monospace;" v-model.trim="tempBlock.Label"></textarea>
      <label>, TerminalsIn:</label>
      <div class="w3-row">
        <div class="w3-col s3">
          <label>Minimum</label>
          <input class="w3-input w3-border w3-border-theme" v-model.number="tempBlock.TerminalsIn.min" type="number" />
        </div>
        <div class="w3-col s3">
          <label>Maximum</label>
          <input class="w3-input w3-border w3-border-theme" v-model.number="tempBlock.TerminalsIn.max" type="number" />
        </div>
        <div class="w3-col s3">
          <label>Value</label>
          <input class="w3-input w3-border w3-border-theme" v-model.number="tempBlock.TerminalsIn.value"
            type="number" />
        </div>
        <div class="w3-col s3">
          <label for="InputTerminalsCountEditable">Editable</label>
          <input id="InputTerminalsCountEditable" class="w3-input w3-border w3-border-theme"
            v-model.trim="tempBlock.TerminalsIn.editable" type="checkbox" />
        </div>
      </div>
      <label>, TerminalsOut:</label>
      <div class="w3-row">
        <div class="w3-col s3">
          <label>Minimum</label>
          <input class="w3-input w3-border w3-border-theme" v-model.number="tempBlock.TerminalsOut.min" type="number" />
        </div>
        <div class="w3-col s3">
          <label>Maximum</label>
          <input class="w3-input w3-border w3-border-theme" v-model.number="tempBlock.TerminalsOut.max" type="number" />
        </div>
        <div class="w3-col s3">
          <label>Value</label>
          <input class="w3-input w3-border w3-border-theme" v-model.number="tempBlock.TerminalsOut.value"
            type="number" />
        </div>
        <div class="w3-col s3">
          <label for="OutputTerminalsCountEditable">Editable</label>
          <input id="OutputTerminalsCountEditable" class="w3-input w3-border w3-border-theme"
            v-model.trim="tempBlock.TerminalsOut.editable" type="checkbox" />
        </div>
      </div>
      <label>, OutTerminals:</label>
      <input class="w3-input w3-border w3-border-theme" v-model.trim="tempBlock.OutTerminals" />
      <label>, Init: function () {</label>
      <textarea class="w3-input w3-border w3-border-theme"
        style="resize: vertical; height: 75%;  font-family: monospace;" v-model.trim="tempBlock.Init"></textarea>
      <label>}, End: function () {</label>
      <textarea class="w3-input w3-border w3-border-theme"
        style="resize: vertical; height: 75%;  font-family: monospace;" v-model.trim="tempBlock.End"></textarea>
      <label>}, Constructor: function () {</label>
      <textarea class="w3-input w3-border w3-border-theme"
        style="resize: vertical; height: 75%;  font-family: monospace;" v-model.trim="tempBlock.Constructor"></textarea>
      <label>}, Destructor: function () {</label>
      <textarea class="w3-input w3-border w3-border-theme"
        style="resize: vertical; height: 75%;  font-family: monospace;" v-model.trim="tempBlock.Destructor"></textarea>
      <label>}, RunTimeExec: function () {</label>
      <textarea class="w3-input w3-border w3-border-theme"
        style="resize: vertical; height: 75%;  font-family: monospace;" v-model.trim="tempBlock.RunTimeExec"></textarea>
      <label>}, Evaluate: function () {</label>
      <textarea class="w3-input w3-border w3-border-theme"
        style="resize: vertical; height: 75%;  font-family: monospace;" v-model.trim="tempBlock.Evaluate"></textarea>
      <label>}, Details: function () {</label>
      <textarea class="w3-input w3-border w3-border-theme"
        style="resize: vertical; height: 75%;  font-family: monospace;" v-model.trim="tempBlock.Details"></textarea>
      <label>}, ValidateParams: function () {</label>
      <textarea class="w3-input w3-border w3-border-theme"
        style="resize: vertical; height: 75%;  font-family: monospace;"
        v-model.trim="tempBlock.ValidateParams"></textarea>
      <label>}}</label>
    </div>
  </div>
  <script>
    //Common.js

    Object.filter = (obj, predicate) =>
      Object.keys(obj)
      .filter(key => predicate(obj[key]))
      .reduce((res, key) => ((res[key] = obj[key]), res), {});
  </script>
  <script>
    function removeAlltheObjectURLsForSVGImages() {
      var i;
      for (
        i = 0; i < document.getElementsByClassName("tempSVGImg").length; i++
      ) {
        var url = document.getElementsByClassName("tempSVGImg")[i].src;
        URL.revokeObjectURL(url);
      }
      console.log("Cleaned images: " + i);
    }

    function generateArrayFromObject() {
      const OutArray = [];
    }
  </script>
  <script src="/js/notyf.min.js"></script>
  <script>
    var notyf = new Notyf();
  </script>
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script>
    var app = new Vue({
      el: "#app",
      data: {
        waitForAProcess: {
          show: 1,
          title: "Loading database",
          text: "Please wait while loading the app. If this process takes longer than a minute, check your internet connection and refresh the page."
        },
        filterForFunctions: "",
        selectedCategory: "sources",
        selectedBlock: null,
        tempSummaryItem: null,
        tempBlock: null,
        toolConsts: {
          toolDiameter: 36,
          canvas: {
            x: 0,
            y: 0
          },
          DOM: {
            x: 0,
            y: 0
          }
        },
        networkConst: {
          scale: 0,
          xView: 0,
          yView: 1,
          halfWidth: 0,
          halfHeight: 0
        },
        blocksSummary: null,
        iconText: {
          icon1: "<svg viewBox='-3 -3 106 106' xmlns='http://www.w3.org/2000/svg'><defs><filter id='f0' x='-50%' y='-50%' width='200%' height='200%'><feGaussianBlur in='SourceAlpha' stdDeviation='1'/><feOffset dx='0' dy='0' result='offsetblur'/><feMerge><feMergeNode/><feMergeNode in='SourceGraphic'/></feMerge></filter><filter id='f1' x='-50%' y='-50%' width='200%' height='200%'><feOffset result='offOut' in='SourceAlpha' dx='3' dy='3' /><feGaussianBlur result='blurOut' in='offOut' stdDeviation='1' /><feBlend in='SourceGraphic' in2='blurOut' mode='normal' /></filter></defs><g><rect rx='20' height='100' width='100' y='0' x='0' stroke-width='0' fill='",
          icon2: "' filter='url(#f0)'/></g><g stroke-linecap='round' filter='url(#f1)' width='100' height='100' stroke='",
          icon3: "' stroke-width='10' fill='none'>",
          icon4: "</g></svg>"
        }
      },
      beforeUpdate: function () {
        //removeAlltheObjectURLsForSVGImages();
      },
      computed: {
        blocksSummaryArray: function () {
          try {
            const tempSourceArray = Object.keys(this.blocksSummary).map(
              function (key) {
                return {
                  key: key,
                  name: app.$data.blocksSummary[key].name,
                  order: app.$data.blocksSummary[key].order
                };
              }
            );
            console.log(tempSourceArray);
            return tempSourceArray.sort((a, b) => a.order - b.order);
          } catch (e) {
            console.log(e);
            console.log("Data is not ready for displaying categories");
          }
        },
        filteredBlocks: function () {
          try {
            const summaryArray = Object.keys(
              this.blocksSummary[this.selectedCategory].blocks
            ).map(function (key) {
              return Object.assign({
                  key: key
                },
                app.$data.blocksSummary[app.$data.selectedCategory].blocks[
                  key
                ]
              );
            });
            return summaryArray
              .filter(summaryArrayItem => {
                return (
                  !app.$data.filterForFunctions ||
                  summaryArrayItem.name
                  .toLowerCase()
                  .search(app.$data.filterForFunctions.toLowerCase()) >=
                  0 ||
                  summaryArrayItem.description
                  .toLowerCase()
                  .search(app.$data.filterForFunctions.toLowerCase()) >= 0
                );
              })
              .sort((a, b) => {
                return a.order - b.order;
              });
          } catch (e) {
            console.log(e);
            console.log("Data is not ready for applying filter");
          }
        }
      },
      methods: {
        copyIconForBlock: function () {
          var svg =
            "<svg viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'><g stroke-linecap='round' width='100' height='100' stroke='#ffffff' stroke-width='10' fill='none'>" +
            this.tempSummaryItem.icon +
            "</g></svg>";
            var src = "data:image/svg+xml;charset=utf-8," + encodeURIComponent(svg);
            var tag = "<img src=\\\""+src+"\\\" style='width:100%;'>";
            copyTextToClipboard(tag);
            notyf.success("Copied icon for block to the clipboard")
        },
        addIconTag: function (index = -1) {
          let tempText = "";
          switch (index) {
            case 0:
              tempText =
                "<text x='50' y='57' dominant-baseline='middle' text-anchor='middle' font-size='5em'>A</text>";
              break;
            case 1:
              tempText = "<line x1='20' y1='20' x2= '80' y2='80'/>";
              break;
            case 2:
              tempText = "<polyline points='10,10 90,30 10,50 90,70 10,90'/>";
              break;
            case 3:
              tempText = "<path d='M 10 10 q 40 160 80 0'/>";
              break;
            case 4:
              tempText = "<polygon points='20,20 90,50 80,80 50,90'/>";
              break;
            case 5:
              tempText = "<rect x='20' y='20' width='60' height='60'/>";
              break;
            case 6:
              tempText = "<circle cx='50' cy='50' r='30'/>";
              break;
            case 7:
              tempText = "<ellipse cx='50' cy='50' rx='40' ry='20'/>";
              break;
            case -1:
              this.tempSummaryItem.icon = "";
          }
          this.tempSummaryItem.icon += tempText;
        },
        prepareSVGURL: function (svg) {
          svg =
            this.iconText.icon1 +
            this.blocksSummary[this.selectedCategory].colors.bg +
            this.iconText.icon2 +
            "#ffffff" +
            this.iconText.icon3 +
            svg +
            this.iconText.icon4;
          return (
            "data:image/svg+xml;charset=utf-8," + encodeURIComponent(svg)
          );
        },
        svgTextToURL: function (svg) {
          svg =
            this.iconText.icon1 +
            this.blocksSummary[this.selectedCategory].colors.bg +
            this.iconText.icon2 +
            this.blocksSummary[this.selectedCategory].colors.fg +
            this.iconText.icon3 +
            svg +
            this.iconText.icon4;
          let tempBlob = new Blob([svg], {
            type: "image/svg+xml"
          });
          let url = URL.createObjectURL(tempBlob);
          return url;
        },
        showSummaryItem: function (index = Date.now().toString()) {
          this.blocksSummary[this.selectedCategory].blocks = Object.assign({},
            this.blocksSummary[this.selectedCategory].blocks
          );
          console.log(this.selectedCategory);
          this.tempSummaryItem = Object.assign({
              name: "",
              description: "",
              icon: "",
              order: "",
              size: {
                width: 50,
                height: 50
              }
            },
            this.blocksSummary[this.selectedCategory].blocks[index]
          );
          this.waitForAProcess.title = "Loading the block details";
          this.waitForAProcess.show++;
          db.collection("blocks")
            .doc(index)
            .get()
            .then(function (doc) {
              app.finishingShowSummaryItem(doc.data(), index);
            })
            .catch(function (error) {
              app.finishingShowSummaryItem({}, index);
            });
        },
        finishingShowSummaryItem: function (data, index) {
          this.tempBlock = Object.assign({
              bid: "",
              Name: "",
              Description: "",
              Icon: "",
              Parameters: "",
              Label: "",
              FirstInExecutionOrder: false,
              TerminalsIn: {
                min: 0,
                max: 0,
                value: 0,
                editable: false
              },
              TerminalsOut: {
                min: 0,
                max: 0,
                value: 0,
                editable: false
              },
              Init: "",
              End: "",
              Constructor: "",
              Destructor: "",
              RunTimeExec: "",
              Evaluate: "",
              Details: "",
              ValidateParams: ""
            },
            data
          );
          if (app.$data.waitForAProcess.show) this.waitForAProcess.show--;
          this.selectedBlock = index;
        },
        saveDataToServer: function (close = false) {
          app.$data.waitForAProcess.title = "Saving the block details";
          app.$data.waitForAProcess.show++;
          app.$data.blocksSummary[app.$data.selectedCategory].blocks[
            app.$data.selectedBlock
          ] = Object.assign({}, app.$data.tempSummaryItem);
          db.collection("blocks-summary")
            .doc(app.$data.selectedCategory)
            .update(app.$data.blocksSummary[app.$data.selectedCategory])
            .then(function () {
              notyf.success("Block summary saved");
              app.$data.tempBlock["bid"] = app.$data.selectedBlock;
              app.$data.tempBlock["Colors"] =
                app.$data.blocksSummary[app.$data.selectedCategory].colors;
              app.$data.tempBlock["Name"] = app.$data.tempSummaryItem["name"];
              app.$data.tempBlock["Description"] =
                app.$data.tempSummaryItem["description"];
              app.$data.tempBlock["Category"] = app.$data.selectedCategory;
              db.collection("blocks")
                .doc(app.$data.selectedBlock)
                .set(app.$data.tempBlock)
                .then(function () {
                  notyf.success("Block saved");
                  if (app.$data.waitForAProcess.show)
                    app.$data.waitForAProcess.show--;
                  if (close) app.$data.selectedBlock = null;
                })
                .catch(function (e) {
                  notyf.error("Unable to save the block");
                  if (app.$data.waitForAProcess.show)
                    app.$data.waitForAProcess.show--;
                  console.dir(e);
                });
            })
            .catch(function (e) {
              notyf.error("Unable to save the block summary");
              console.dir(e);
              if (app.$data.waitForAProcess.show)
                app.$data.waitForAProcess.show--;
            });
        },
        deleteDataOnServer: function () {
          if (
            confirm(
              "I mistakenly pressed the delete button.\nI don't want to delete.\nPress cancel to delete"
            )
          ) {
            notyf.success("Delete operation is cancelled");
          } else {
            app.$data.waitForAProcess.title =
              "Deleting the block from server";
            app.$data.waitForAProcess.show++;
            delete app.$data.blocksSummary[app.$data.selectedCategory].blocks[
              app.$data.selectedBlock
            ];
            db.collection("blocks-summary")
              .doc(app.$data.selectedCategory)
              .update(app.$data.blocksSummary[app.$data.selectedCategory])
              .then(function () {
                notyf.success("Block summary deleted");
                db.collection("blocks")
                  .doc(app.$data.selectedBlock)
                  .delete()
                  .then(function () {
                    notyf.success("Block deleted");
                    if (app.$data.waitForAProcess.show)
                      app.$data.waitForAProcess.show--;
                    app.$data.selectedBlock = null;
                  })
                  .catch(function (e) {
                    notyf.error("Unable to delete the block");
                    if (app.$data.waitForAProcess.show)
                      app.$data.waitForAProcess.show--;
                    console.dir(e);
                    app.$data.selectedBlock = null;
                  });
              })
              .catch(function (e) {
                notyf.error("Unable to delete the block summary");
                console.dir(e);
                if (app.$data.waitForAProcess.show)
                  app.$data.waitForAProcess.show--;
              });
          }
        }
      }
    });
  </script>

  <script></script>
  <script>
    const functions = firebase.functions();
    const db = firebase.firestore();
    const settings = {
      timestampsInSnapshots: true
    };
    db.settings(settings);
    var validateUserSession = firebase
      .functions()
      .httpsCallable("validateUserSession");
    var TempRecAttempt;
    firebase.auth().onAuthStateChanged(function (user) {
      TempRecAttempt = setInterval(function () {
        console.log("attempt");
        if (app) {
          app.$data.waitForAProcess.title = "Verifying the license.";
          clearInterval(TempRecAttempt);
          user ? handleSignedInUser(user) : handleSignedOutUser();
        }
      }, 500);
    });

    function handleSignedInUser(user) {
      if (user.uid === "4DYtf7b8cBVgvDJ1Taiz3cPK9qI2") {
        app.$data.waitForAProcess.title = "Loading function blocks summary.";
        db.collection("blocks-summary")
          .get()
          .then(function (querySnapshot) {
            querySnapshot.forEach(function (doc) {
              app.$data.waitForAProcess.show++;
              db.collection("blocks-summary")
                .doc(doc.id)
                .onSnapshot(function (doc) {
                  console.log(doc.id, " => ", doc.data());
                  if (!app.$data.blocksSummary)
                    app.$set(app.$data, "blocksSummary", {});
                  app.$set(app.$data.blocksSummary, doc.id, doc.data());
                  if (app.$data.waitForAProcess.show)
                    app.$data.waitForAProcess.show--;
                });
            });
          });
        if (app.$data.waitForAProcess.show) app.$data.waitForAProcess.show--;
        loadTheGUI();
      } else window.location.replace("/platform/admin");
    }

    function handleSignedOutUser() {
      window.location.replace("/sign-in?redirect=" + location.pathname);
    }

    function loadTheGUI() {}

    function fallbackCopyTextToClipboard(text) {
      var textArea = document.createElement("textarea");
      textArea.value = text;
      document.body.appendChild(textArea);
      textArea.focus();
      textArea.select();

      try {
        var successful = document.execCommand('copy');
        var msg = successful ? 'successful' : 'unsuccessful';
        console.log('Fallback: Copying text command was ' + msg);
      } catch (err) {
        console.error('Fallback: Oops, unable to copy', err);
      }

      document.body.removeChild(textArea);
    }

    function copyTextToClipboard(text) {
      if (!navigator.clipboard) {
        fallbackCopyTextToClipboard(text);
        return;
      }
      navigator.clipboard.writeText(text).then(function () {
        console.log('Async: Copying to clipboard was successful!');
      }, function (err) {
        console.error('Async: Could not copy text: ', err);
      });
    }
  </script>
</body>

</html>